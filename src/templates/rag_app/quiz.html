{% extends "base.html" %}
{% load static %}

{% block title %}Quiz - EduMentorAI{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/quiz.css' %}">
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/quiz.js' %}"></script>
{% endblock %}

{% block content %}
<div class="quiz-container">
    {% if quiz %}
    <div class="quiz-header">
        <h1 class="quiz-title">{{ quiz.title }}</h1>
        <div class="quiz-meta">
            <div class="meta-item">
                <i class="fas fa-book"></i>
                <span>{{ quiz.subject.name }}</span>
            </div>
            <div class="meta-item">
                <i class="fas fa-question-circle"></i>
                <span>{{ quiz.questions.count }} Questions</span>
            </div>
            <div class="meta-item">
                <i class="fas fa-clock"></i>
                <span>No time limit</span>
            </div>
        </div>
    </div>

    <form id="quizForm" method="post">
        {% csrf_token %}
        <input type="hidden" name="quiz_id" value="{{ quiz.id }}">
        
        {% for question in quiz.questions.all %}
        <div class="question-card" data-question="{{ forloop.counter0 }}" 
             {% if forloop.first %}style="display: block;"{% else %}style="display: none;"{% endif %}>
            <div class="question-header">
                <div class="question-number">{{ forloop.counter }}</div>
                <div class="question-type">{{ question.get_question_type_display }}</div>
            </div>
            
            <div class="question-content">
                <div class="question-text">{{ question.question_text }}</div>
                
                <div class="choices-container">
                    {% for choice in question.choices.all %}
                    <label class="choice" for="choice_{{ question.id }}_{{ choice.id }}">
                        <input type="radio" 
                               id="choice_{{ question.id }}_{{ choice.id }}"
                               name="question_{{ question.id }}" 
                               value="{{ choice.id }}"
                               class="choice-input">
                        <span class="choice-label">{{ choice.choice_text }}</span>
                        <span class="choice-indicator">
                            <i class="fas fa-check text-green-500"></i>
                            <i class="fas fa-times text-red-500"></i>
                        </span>
                    </label>
                    {% endfor %}
                </div>
                
                {% if question.explanation %}
                <div class="explanation" id="explanation_{{ question.id }}">
                    <div class="explanation-title">
                        <i class="fas fa-lightbulb"></i>
                        Explanation
                    </div>
                    <div class="explanation-text">{{ question.explanation }}</div>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}

        <div class="quiz-navigation">
            <button type="button" class="nav-button btn-previous" id="prevBtn" disabled>
                <i class="fas fa-arrow-left"></i>
                Previous
            </button>
            
            <div class="progress-indicator">
                <span class="progress-text" id="progressText">1 of {{ quiz.questions.count }}</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 10%;"></div>
                </div>
            </div>
            
            <button type="button" class="nav-button btn-next" id="nextBtn">
                Next
                <i class="fas fa-arrow-right"></i>
            </button>
            
            <button type="submit" class="nav-button btn-submit" id="submitBtn" style="display: none;">
                <i class="fas fa-check"></i>
                Submit Quiz
            </button>
        </div>
    </form>
    
    {% else %}
    <div class="quiz-results">
        <h2>Quiz Not Found</h2>
        <p>The quiz you're looking for doesn't exist or has been removed.</p>
        <div class="results-actions">
            <a href="{% url 'rag_app:dashboard' %}" class="nav-button btn-next">
                <i class="fas fa-home"></i>
                Back to Dashboard
            </a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}


