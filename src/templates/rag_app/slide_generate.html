{% extends "base.html" %}
{% load static %}

{% block title %}Generate Slides - EduMentorAI{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/slide_generate.css' %}">
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/slide_generate.js' %}"></script>
{% endblock %}

{% block content %}
<div class="slide-generator-container">
    <div class="text-center mb-4">
        <h1 class="display-5 fw-bold text-primary">
            <i class="fas fa-presentation me-3"></i>
            Generate PowerPoint Slides
        </h1>
        <p class="lead text-muted">
            Upload your documents and let AI create professional presentation slides for you
        </p>
        
        <!-- AI Status Indicator -->
        {% if ai_available %}
            <div class="alert alert-success d-inline-block">
                <i class="fas fa-robot me-2"></i>
                <strong>AI-Powered Generation Enabled</strong> - Advanced content analysis and slide creation
            </div>
        {% else %}
            <div class="alert alert-warning d-inline-block">
                <i class="fas fa-cog me-2"></i>
                <strong>Basic Generation Mode</strong> - AI features require OpenRouter API key configuration
            </div>
        {% endif %}
    </div>

    <form id="slideGeneratorForm" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <!-- File Upload Area -->
        <div class="upload-area" id="uploadArea">
            <i class="fas fa-cloud-upload-alt upload-icon"></i>
            <h4 class="fw-bold text-success mb-3">Drop your files here</h4>
            <p class="text-muted mb-3">or click to browse and select files</p>
            <input type="file" 
                   name="documents" 
                   id="fileInput" 
                   class="file-input" 
                   multiple 
                   accept=".pdf,.doc,.docx,.txt,.ppt,.pptx">
            <button type="button" class="btn btn-outline-success btn-lg">
                <i class="fas fa-folder-open me-2"></i>
                Choose Files
            </button>
        </div>

        <!-- Supported Formats -->
        <div class="supported-formats">
            <small class="text-muted">Supported formats:</small><br>
            <span class="format-badge">PDF</span>
            <span class="format-badge">TXT</span>
        </div>

        <!-- File Preview -->
        <div class="file-preview" id="filePreview">
            <h5 class="fw-bold text-primary mb-3">
                <i class="fas fa-files me-2"></i>
                Selected Files
            </h5>
            <div id="fileList"></div>
        </div>

        <!-- Slide Generation Options -->
        <div class="slide-options">
            <h5 class="fw-bold text-primary mb-4">
                <i class="fas fa-cogs me-2"></i>
                Presentation Options
            </h5>

            <div class="row">
                <div class="col-md-6">
                    <div class="option-group">
                        <label for="slideCount">Number of Slides</label>
                        <select name="slide_count" id="slideCount" class="form-select">
                            <option value="auto">Auto (Based on content)</option>
                            <option value="5">5 slides</option>
                            <option value="10" selected>10 slides</option>
                            <option value="15">15 slides</option>
                            <option value="20">20 slides</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="option-group">
                        <label for="slideTemplate">Template Style</label>
                        <select name="template" id="slideTemplate" class="form-select">
                            <option value="professional">Professional</option>
                            <option value="academic">Academic</option>
                            <option value="creative">Creative</option>
                            <option value="minimal">Minimal</option>
                            <option value="corporate">Corporate</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="option-group">
                        <label for="bgImage">Custom Background Image (optional)</label>
                        <input type="file" name="background_image" id="bgImage" class="form-control" accept="image/*">
                        <small class="text-muted">JPEG/PNG recommended. Used as slide background.</small>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="option-group" id="bgPreviewWrap" style="display: none;">
                        <label>Background Preview</label>
                        <img id="bgPreview" alt="Background preview" style="max-width: 100%; border-radius: 8px; border: 1px solid var(--border-color);" />
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="option-group">
                        <label for="presentationTitle">Presentation Title</label>
                        <input type="text" 
                               name="title" 
                               id="presentationTitle" 
                               class="form-control" 
                               placeholder="Enter presentation title (optional)">
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="option-group">
                        <label for="language">Language</label>
                        <select name="language" id="language" class="form-select">
                            <option value="en">English</option>
                            <option value="es">Spanish</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="it">Italian</option>
                            <option value="pt">Portuguese</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="option-group">
                <label for="additionalInstructions">Additional Instructions</label>
                <textarea name="instructions" 
                          id="additionalInstructions" 
                          class="form-control" 
                          rows="3" 
                          placeholder="Any specific requirements for your slides? (e.g., focus on key concepts, include graphs, target audience, etc.)"></textarea>
            </div>

            <!-- Custom slide count input (hidden by default) -->
            <div class="option-group" id="customSlideCount" style="display: none;">
                <label for="customCount">Custom Number of Slides</label>
                <input type="number" 
                       name="custom_slide_count" 
                       id="customCount" 
                       class="form-control" 
                       min="1" 
                       max="50" 
                       placeholder="Enter number of slides">
            </div>
        </div>

        <!-- Generate Button -->
        <div class="text-center mt-4">
            <button type="submit" 
                    id="generateBtn" 
                    class="btn generate-btn btn-lg" 
                    disabled>
                <i class="fas fa-magic me-2"></i>
                Generate Slides
            </button>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container" id="progressContainer">
            <h6 class="fw-bold text-primary mb-3">
                <i class="fas fa-spinner fa-spin me-2"></i>
                Generating your presentation...
            </h6>
            <div class="progress">
                <div class="progress-bar" 
                     role="progressbar" 
                     style="width: 0%" 
                     id="progressBar">
                    <span class="sr-only">0% Complete</span>
                </div>
            </div>
            <p class="text-center mt-2 mb-0">
                <small class="text-muted" id="progressText">Initializing...</small>
            </p>
        </div>
    </form>
</div>
{% endblock %}

